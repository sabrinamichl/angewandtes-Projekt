```{r}
library(tidyverse)
library(readxl)
library(skimr)
library(corrr)
library(rstanarm)
library(bayestestR)
library(bayesplot)
library(tidymodels)
library(corrplot)
```

```{r}
options(mc.cores = parallel::detectCores())
```

```{r}
conflicted::conflict_prefer("select", "dplyr")
conflicted::conflict_prefer("filter", "dplyr")
```

# 1. Vorbereitung der Daten
## Daten einlesen
```{r}
d_raw <- read_excel("raw_data.xlsx")
```

## Unnötige Variablen entfernen
```{r}
raw1 <- d_raw %>% 
  select(-c(CASE, SERIAL, REF, QUESTNNR, MODE, STARTED, TIME001:TIME012, MAILSENT, LASTDATA, FINISHED, Q_VIEWER, LASTPAGE, MAXPAGE, MISSREL, MISSING))
```

## Variablenbeschreibung (Zeile) entfernen
```{r}
raw1 = raw1[-1,]
```


## Spaltennamen umbenennen
```{r}
names(raw1) <- c("Alter", "Geschlecht", "Bildung", "Bildung_sonstig", "BZG_J", "BZG_M", "Beschaeftigungsart", "Arbeitszeitmodell", "Gehalt", "Position_im_Unternehmen", "Remotarbeit", "IS_K01", "IS_K02", "IS_K03", "IS_K04", "IS_E05", "IS_E06", "IS_E07", "IS_E08", "OC_A01", "OC_A02", "OC_A03", "OC_A04", "OC_A05", "CPE_C01", "CPE_C02", "CPE_C03", "CPE_C04", "CPE_I05", "CPE_I06", "CPE_I07", "CPE_I08", "CPE_M09", "CPE_M10", "CPE_M11", "CPE_M12", "CPE_E13", "CPE_E14", "CPE_E15", "CPE_E16", "PS_01", "PS_02", "PS_03", "PS_04", "PS_05", "PS_06", "PS_07", "QQ_01", "QQ_02", "QQ_03", "QQ_04", "QQ_05", "QQ_06", "QQ_07", "QQ_N08", "QQ_N09", "QQ_N10", "QQ_N11", "QQ_N12", "QQ_N13", "QQ_N14", "SL_01", "SL_02", "SL_03", "SL_04", "SL_05", "SL_06", "SL_07", "ZE01", "ZE04", "TIME_SUM", "TIME_RSI")
```


## ID-Spalte einfügen
```{r}
raw2 <- raw1 %>% 
  mutate(ID = row_number()) %>% 
  select(ID, everything())
```


## Kompletten Datensatz auf NA's prüfen
```{r}
raw2 %>% 
  summarise(across(everything(), 
                   ~sum(is.na(.))))
```

```{r}
skim(raw2)
```
  > NA bei CPE_M11 & SL_05 --> später prüfen, wenn Werte numerisch sind! (vgl. 4.!)


# 2. Negative gepolte Items prüfen
## Recodieren der Psychologische Sicherheit Items
```{r}
raw3 <- raw2 %>% 
  mutate(across(
    .cols = c(PS_03, PS_05, PS_06),
    .fns = ~ dplyr::recode(.,
                    `1` = 7,
                    `2` = 6,
                    `3` = 5,
                    `4` = 4,
                    `5` = 3,
                    `6` = 2,
                    `7` = 1)))
```

## Recodieren des organisationalen Commitments
```{r}
raw4 <- raw3 %>% 
  mutate(across(
    .cols = OC_A02,
    .fns = ~dplyr::recode(.,
                    `1` = 5,
                    `2` = 4,
                    `3` = 3,
                    `4` = 2,
                    `5` = 1)))
```

# 3. Variablen umkodieren
```{r}
raw4$Geschlecht <- as.numeric(raw4$Geschlecht)
raw4$Alter <- as.numeric(raw4$Alter)
raw4$Bildung <- as.numeric(raw4$Bildung)
raw4$BZG_J <- as.numeric(raw4$BZG_J)
raw4$BZG_M <- as.numeric(raw4$BZG_M)
raw4$Arbeitszeitmodell <- as.numeric(raw4$Arbeitszeitmodell)
raw4$Beschaeftigungsart <- as.numeric(raw4$Beschaeftigungsart)
raw4$Gehalt <- as.numeric(raw4$Gehalt)
raw4$Position_im_Unternehmen <- as.numeric(raw4$Position_im_Unternehmen)
raw4$Remotarbeit <- as.numeric(raw4$Remotarbeit)
```

```{r}
raw4$IS_K01 <- as.numeric(raw4$IS_K01)
raw4$IS_K02 <- as.numeric(raw4$IS_K02)
raw4$IS_K03 <- as.numeric(raw4$IS_K03)
raw4$IS_K04 <- as.numeric(raw4$IS_K04)
raw4$IS_E05 <- as.numeric(raw4$IS_E05)
raw4$IS_E06 <- as.numeric(raw4$IS_E06)
raw4$IS_E07 <- as.numeric(raw4$IS_E07)
raw4$IS_E08 <- as.numeric(raw4$IS_E08)
```

```{r}
raw4$OC_A01 <- as.numeric(raw4$OC_A01)
raw4$OC_A02 <- as.numeric(raw4$OC_A02)
raw4$OC_A03 <- as.numeric(raw4$OC_A03)
raw4$OC_A04 <- as.numeric(raw4$OC_A04)
raw4$OC_A05 <- as.numeric(raw4$OC_A05)
```

```{r}
raw4$CPE_C01 <- as.numeric(raw4$CPE_C01)
raw4$CPE_C02 <- as.numeric(raw4$CPE_C02)
raw4$CPE_C03 <- as.numeric(raw4$CPE_C03)
raw4$CPE_C04 <- as.numeric(raw4$CPE_C04)
raw4$CPE_I05 <- as.numeric(raw4$CPE_I05)
raw4$CPE_I06 <- as.numeric(raw4$CPE_I06)
raw4$CPE_I07 <- as.numeric(raw4$CPE_I07)
raw4$CPE_I08 <- as.numeric(raw4$CPE_I08)
raw4$CPE_M09 <- as.numeric(raw4$CPE_M09)
raw4$CPE_M10 <- as.numeric(raw4$CPE_M10)
raw4$CPE_M11 <- as.numeric(raw4$CPE_M11)
raw4$CPE_M12 <- as.numeric(raw4$CPE_M12)
raw4$CPE_E13 <- as.numeric(raw4$CPE_E13)
raw4$CPE_E14 <- as.numeric(raw4$CPE_E14)
raw4$CPE_E15 <- as.numeric(raw4$CPE_E15)
raw4$CPE_E16 <- as.numeric(raw4$CPE_E16)
```

```{r}
raw4$PS_01 <- as.numeric(raw4$PS_01)
raw4$PS_02 <- as.numeric(raw4$PS_02)
raw4$PS_03 <- as.numeric(raw4$PS_03)
raw4$PS_04 <- as.numeric(raw4$PS_04)
raw4$PS_05 <- as.numeric(raw4$PS_05)
raw4$PS_06 <- as.numeric(raw4$PS_06)
raw4$PS_07 <- as.numeric(raw4$PS_07)
```

```{r}
raw4$QQ_01 <- as.numeric(raw4$QQ_01)
raw4$QQ_02 <- as.numeric(raw4$QQ_02)
raw4$QQ_03 <- as.numeric(raw4$QQ_03)
raw4$QQ_04 <- as.numeric(raw4$QQ_04)
raw4$QQ_05 <- as.numeric(raw4$QQ_05)
raw4$QQ_06 <- as.numeric(raw4$QQ_06)
raw4$QQ_07 <- as.numeric(raw4$QQ_07)
```

```{r}
raw4$QQ_N08 <- as.numeric(raw4$QQ_N08)
raw4$QQ_N09 <- as.numeric(raw4$QQ_N09)
raw4$QQ_N10 <- as.numeric(raw4$QQ_N10)
raw4$QQ_N11 <- as.numeric(raw4$QQ_N11)
raw4$QQ_N12 <- as.numeric(raw4$QQ_N12)
raw4$QQ_N13 <- as.numeric(raw4$QQ_N13)
raw4$QQ_N14 <- as.numeric(raw4$QQ_N14)
```

```{r}
raw4$SL_01 <- as.numeric(raw4$SL_01)
raw4$SL_02 <- as.numeric(raw4$SL_02)
raw4$SL_03 <- as.numeric(raw4$SL_03)
raw4$SL_04 <- as.numeric(raw4$SL_04)
raw4$SL_05 <- as.numeric(raw4$SL_05)
raw4$SL_06 <- as.numeric(raw4$SL_06)
raw4$SL_07 <- as.numeric(raw4$SL_07)
```

```{r}
raw4$ZE01 <- as.numeric(raw4$ZE01)
raw4$ZE04 <- as.numeric(raw4$ZE04)
raw4$TIME_SUM <- as.numeric(raw4$TIME_SUM)
raw4$TIME_RSI <- as.numeric(raw4$TIME_RSI)
```

## Bearbeitungszeit 
```{r}
raw4_1 <- raw4 %>% 
  mutate(Time_sum_m = TIME_SUM / 60)
```

```{r}
raw4_1 %>% 
  summarise(median = median(Time_sum_m),
            sd = sd(Time_sum_m))
```
  > Alles was größer oder kleiner als 2 SD ist wird nochmal genauer betrachtet!

```{r}
raw4_1 %>% 
  filter(Time_sum_m < 4.450805 | Time_sum_m > 15.53253) %>% 
  select(ID, Alter, Geschlecht, Bildung, Time_sum_m, everything())
```
  > Wie sich zeigt, haben zwei Probanden den Fragebogen unter 2 SD vom Median beantwortet, weswegen diese aus dem Datensatz entfernt werden. Da weitere 5 Probanden länger als 2 SD vom Median zur Beantwortung benötigt haben, diese jedoch alle um die 50 Jahre oder älter sind, wird es von der gesamten Gruppe als logisch empfunden, dass diese Gruppe gegebenenfalls eher länger benötigt.


### Personen mit einer unterdurchschnittlichen Bearbeitungsdauer rausschmeißen
```{r}
drops <-c(15, 106)
```

```{r}
raw4_2 <- raw4_1[-drops,]
```

### Daten neu sortieren
```{r}
raw4_3 <- raw4_2 %>% 
  select(-ID) %>% 
  mutate(ID = row_number()) %>% 
  select(ID, Alter, Geschlecht, Bildung, Bildung_sonstig, BZG_J, BZG_M, Beschaeftigungsart, Arbeitszeitmodell, Gehalt, Position_im_Unternehmen, Remotarbeit, everything())
```

### Daten checken
```{r}
raw4_3 %>% 
  filter(Time_sum_m < 4.450805 | Time_sum_m > 15.53253) %>% 
  select(ID, Alter, Geschlecht, Bildung, Time_sum_m, everything())
```

# 4. Mittelwerte der jeweiligen Items mit NA's anschauen
```{r}
raw4_3 %>% 
  summarise(mean_CPE_M11 = mean(CPE_M11, na.rm=TRUE),
            mean_SL_05 = mean(SL_05, na.rm=TRUE))
```

## Spalten mit NA's heraussuchen
```{r}
raw4_3 %>% 
  filter(is.na(CPE_M11 | SL_05))
```
  > Eine Person (ID = 61) hat also weder eine Angabe zu CPE_M11 und SL_05 gemacht! Da ansonsten alle Werte vorhanden sind, werden diese NA's durch die Mittelwerte ausgetauscht!
  
### Austauschen der Werte
```{r}
raw4_3$CPE_M11[60] <- 4.656085
raw4_3$SL_05[60] <- 3.42328
```

### NA's checken
```{r}
skim(raw4_3)
```

# 5. `BZG_J` und `BZG_M` zusammenrechnen
## BZG_M NA's mit Nullen austauschen
```{r}
raw4_3 %>% 
  filter(is.na(BZG_M))
```

```{r}
raw4_3$BZG_M[38] <- 0
raw4_3$BZG_M[41] <- 0
raw4_3$BZG_M[105] <- 0
raw4_3$BZG_M[147] <- 0
raw4_3$BZG_M[150] <- 0
```

```{r}
raw4_3 %>% 
  filter(is.na(BZG_M))
```

## BZG-Variablen umrechnen
```{r}
raw4a <- raw4_3 %>% 
  mutate(BZG_JM = (BZG_J*12)) %>% 
  mutate(BZG = (BZG_JM+BZG_M)/12) %>% 
  select(-c(BZG_J, BZG_M, BZG_JM)) %>% 
  select(ID, Alter, Geschlecht, Bildung, Bildung_sonstig, BZG, everything())
```

##  BZG genauer betrachten
```{r}
raw4a %>% 
  filter(BZG < 1) %>% 
  count()
```
 > 31 Personen sind weniger als 1 Jahr bei ihrem aktuellen Unternehmen beschäftigt


### Deskriptive Werte von BZG betrachten
```{r}
raw4a %>% 
  summarise(mean = mean(BZG),
            median = median(BZG),
         sd = sd(BZG),
         max = max(BZG),
         min = min(BZG))
```

 
# 6. Verteilungen der Soziodemografika
## Geschlecht
```{r}
raw4a %>% 
  count(Geschlecht) %>% 
  mutate(prob = n/sum(n)) %>%
  round(2)
```

## Alter
```{r}
raw4a %>% 
  summarise(mean(Alter, na.rm=TRUE),
            median(Alter, na.rm=TRUE),
         sd(Alter, na.rm=TRUE), 
         max(Alter, na.rm =TRUE),
         min(Alter, na.rm=TRUE))
```

```{r}
raw4a %>% 
  filter(Alter > 60)
```


### visuelle Darstellung des Alters
```{r}
raw4a %>% 
  ggplot()+
  aes(x=Alter)+
  geom_histogram(fill = "bisque3")+
  geom_vline(xintercept=39.10106 , color="thistle2", size=2)+
  geom_vline(xintercept=52.62487, color="turquoise1", size=1)+
  geom_vline(xintercept=25.57725, color="turquoise1", size=1)+
  theme_minimal()
```


## Bildung
```{r}
raw4a %>% 
  count(Bildung) %>% 
  mutate(prob = n/sum(n)) %>% 
  round(2)
```

### Visuelle Darstellung der Bildung
```{r}
raw4a %>% 
  ggplot()+
  aes(x=Bildung)+
  geom_histogram(fill = "green4")+
  theme_minimal()
```


## Arbeitszeitmodell
```{r}
raw4a %>% 
  summarise(mean = mean(Arbeitszeitmodell, na.rm=TRUE),
            median = median(Arbeitszeitmodell, na.rm=TRUE),
         sd = sd(Arbeitszeitmodell, na.rm=TRUE),
         min = min(Arbeitszeitmodell, na.rm=TRUE),
         max = max(Arbeitszeitmodell, na.rm=TRUE))
```

### Visuelle Darstellung der verschiedenen Arbeitsmodelle
```{r}
raw4a %>% 
  ggplot()+
  aes(x=Arbeitszeitmodell)+
  geom_histogram(fill = "green4")+
  theme_minimal()
```
### Arbeitszeitmodell Extremwerte betrachten
```{r}
raw4a %>% 
  filter(Arbeitszeitmodell < 10 | Arbeitszeitmodell > 45) %>% 
  arrange(desc(Arbeitszeitmodell)) %>% 
  select(ID, Alter, Geschlecht, Bildung, Arbeitszeitmodell, everything())
```

## Gehalt
```{r}
raw4a %>% 
  count(Gehalt) %>% 
  mutate(prob = n/sum(n)) %>% 
  round(2)
```

### Visuelle Darstellung des Gehalts
```{r}
raw4a %>% 
  ggplot()+
  aes(x=Gehalt)+
  geom_histogram(fill = "green4")+
  theme_minimal()
```

## Position im Unternehmen
```{r}
raw4a %>% 
  count(Position_im_Unternehmen) %>% 
  mutate(prob = n/sum(n)) %>% 
  round(2)
```

### Visuelle Darstellung der Position im Unternehmen
```{r}
raw4a %>% 
  ggplot()+
  aes(x=Position_im_Unternehmen)+
  geom_histogram(fill = "green4")+
  theme_minimal()
```


## Remotearbeit
```{r}
raw4a %>% 
  count(Remotarbeit) %>% 
  mutate(prob = n/sum(n)) %>% 
  round(2)
```

### Visuelle Darstellung der Remotearbeit
```{r}
raw4a %>% 
  ggplot()+
  aes(x=Remotarbeit)+
  geom_bar(fill = "green4")+
  theme_minimal()
```


# 7. Kurzen Datensatz `raw` abspeichern
```{r}
write.csv(raw4a, file="raw4.csv")
```

# 8. Cronbachs Alpha berechnen
## Irritation
```{r}
psych::alpha(subset(raw4a, select=c(IS_K01:IS_E08)), check.keys=TRUE)
```

## CPE
```{r}
psych::alpha(subset(raw4a, select=c(CPE_C01:CPE_E16)), check.keys=TRUE)
```

## PS
```{r}
psych::alpha(subset(raw4a, select=c(PS_01:PS_07)), check.keys=TRUE)
```

## OCA
```{r}
psych::alpha(subset(raw4a, select=c(OC_A01:OC_A05)), check.keys=TRUE)
```

## QQ
## QQ (Anand)
```{r}
psych::alpha(subset(raw4a, select=c(QQ_01:QQ_07), check.keys=TRUE))
```

### QQ-Neu
```{r}
psych::alpha(subset(raw4a, select=c(QQ_N08:QQ_N14), check.keys=TRUE))
```

### QQ-Gesamt
```{r}
psych::alpha(subset(raw4a, select=c(QQ_01:QQ_N14), check.keys=TRUE))
```
  > Wie bereits im der oberen Analyse der neuen Fragen bereits gesehen, fällt auch in der Gesamtbetrachtung auf, dass gerade das Item `QQ_N08` eine Item-Rest-Korrelation von 0.208 hat, weswegen dieses Item aus dem Fragebogen fällt

### QQ_N08 aus dem Datensatz werfen
```{r}
raw4b <- raw4a %>% 
  select(-QQ_N08)
```

#### QQ_Gesamt prüfen
```{r}
psych::alpha(subset(raw4b, select=c(QQ_01:QQ_N14), check.keys=TRUE))
```

## SL
```{r}
psych::alpha(subset(raw4b, select=c(SL_01:SL_07)), check.keys=TRUE)
```

# 9. Skalen zusammenfassen
## Irriation (IS)
```{r}
d_work <- raw4b
d_work$IS_mean <- rowMeans(subset(raw4b, select = c(IS_K01, IS_K02, IS_K03, IS_K04, IS_E05, IS_E06, IS_E07, IS_E08)))
d_work$IS_K_mean <- rowMeans(subset(raw4b, select = c(IS_K01, IS_K02, IS_K03, IS_K04)))
d_work$IS_E_mean <- rowMeans(subset(raw4b, select = c(IS_E05, IS_E06, IS_E07, IS_E08)))
```

## Kultur für psychologisches Empowerment in Organisationen (CPE)
```{r}
d_work$CPE_mean <- rowMeans(subset(raw4b, select = c(CPE_C01, CPE_C02, CPE_C03, CPE_C04, CPE_I05, CPE_I06, CPE_I07, CPE_I08, CPE_M09, CPE_M10, CPE_M11, CPE_M12, CPE_E13, CPE_E14, CPE_E15, CPE_E16)))
d_work$CPE_C_mean <- rowMeans(subset(raw4b, select = c(CPE_C01, CPE_C02, CPE_C03, CPE_C04)))
d_work$CPE_I_mean <- rowMeans(subset(raw4b, select = c(CPE_I05, CPE_I06, CPE_I07, CPE_I08)))
d_work$CPE_M_mean <- rowMeans(subset(raw4b, select = c(CPE_M09, CPE_M10, CPE_M11, CPE_M12)))
d_work$CPE_E_mean <- rowMeans(subset(raw4b, select = c(CPE_E13, CPE_E14, CPE_E15, CPE_E16)))
```

## Psychologische Sicherheit (PS)
```{r}
d_work$PS_mean <- rowMeans(subset(raw4b, select = c(PS_01, PS_02, PS_03, PS_04, PS_05, PS_06, PS_07)))
```

## Organisationelles Commitment (OCA)
```{r}
d_work$OC_A_mean <- rowMeans(subset(raw4b, select = c(OC_A01, OC_A02, OC_A03, OC_A04, OC_A05)))
```

## Quiet Quitting
```{r}
d_work$QQ_Anand_mean <- rowMeans(subset(raw4b, select = c(QQ_01, QQ_02, QQ_03, QQ_04, QQ_05, QQ_06, QQ_07)))
d_work$QQ_Eigene_mean <- rowMeans(subset(raw4b, select = c(QQ_N09, QQ_N10, QQ_N11, QQ_N12, QQ_N13, QQ_N14)))
d_work$QQ_Gesamt_mean <- rowMeans(subset(raw4b, select = c(QQ_01, QQ_02, QQ_03, QQ_04, QQ_05, QQ_06, QQ_07, QQ_N09, QQ_N10, QQ_N11, QQ_N12, QQ_N13, QQ_N14)))
```

## Servant Leadership
```{r}
d_work$SL_mean <- rowMeans(subset(raw4b, select = c(SL_01, SL_02, SL_03, SL_04, SL_05, SL_06, SL_07)))
```

## Einzelne Items aus dem Datensatz entfernen
```{r}
d_work_s <- d_work %>% 
  select(-c(IS_K01:IS_E08, OC_A01:OC_A05, CPE_C01:CPE_E16, PS_01:PS_07, QQ_01:QQ_07, QQ_N09:QQ_N14, SL_01:SL_07, TIME_SUM, TIME_RSI)) %>% 
  select(ID, everything())
```

# 10. Kurzen Datensatz `d_work` abspeichern
```{r}
write.csv(d_work_s, file="d_work_s.csv")
```

## Auf NA's im Datensatz prüfen
```{r}
skim(d_work_s)
```


# 11. Korrelationen zwischen den Skalen
```{r}
d_work_s1 <- d_work_s %>% 
  select(ID, IS_mean, IS_K_mean, IS_E_mean, CPE_mean, CPE_C_mean, CPE_I_mean, CPE_M_mean, CPE_E_mean, PS_mean, OC_A_mean, QQ_Anand_mean, QQ_Eigene_mean, QQ_Gesamt_mean, SL_mean)
```

```{r}
d_work_s1 %>% 
  select(where(is.numeric)) %>% 
  correlate() %>% 
  shave()
```

```{r}
subset_cor <- subset(d_work,
                     select = c(ID, Alter, Geschlecht, Bildung, BZG, Beschaeftigungsart, Arbeitszeitmodell, Gehalt, Position_im_Unternehmen, Remotarbeit, IS_mean, IS_K_mean, IS_E_mean, CPE_mean, CPE_C_mean, CPE_I_mean, CPE_M_mean, CPE_E_mean, PS_mean, OC_A_mean, QQ_Anand_mean, QQ_Eigene_mean, QQ_Gesamt_mean, SL_mean))
```

```{r}
library(apaTables)
apa.cor.table(subset_cor, filename = "corr-com.doc", table.number = 2)
```

```{r}
M = cor(subset_cor)
M
corrplot(M, method = 'shade', order = 'AOE', diag = FALSE, col=COL2('PiYG'))
```

# 12. Überprüfung der Hypothesen

## Organisationales Commitment - affektiv `OCA`
### QQ-Anand
```{r}
lm1 <- lm(QQ_Anand_mean ~ OC_A_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm1)
```

```{r}
d_work %>% 
  filter(is.na(Gehalt & Alter))
```

  > Wie im Abschnit 4 gesehen haben wir bei Alter und Gehalt jeweils 2 NA's, jetzt zeigt sich, dass diese drei Personen sich daraus ergeben, dass eine Person fehlende Werte im Alter sowie Gehalt hat.

### Gesamte QQ-Skala
```{r}
lm2 <- lm(QQ_Gesamt_mean ~ OC_A_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm2)
```

## Irritation `IS`
### QQ-Anand
```{r}
lm3 <- lm(QQ_Anand_mean ~ IS_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm3)
```

### Gesamte QQ-Skala
```{r}
lm4 <- lm(QQ_Gesamt_mean ~ IS_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm4)
```

## Kultur für psychologisches Empowerment - `CPE`
### QQ-Anand
```{r}
lm5 <- lm(QQ_Anand_mean ~ CPE_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm5)
```

### Gesamte QQ-Skala
```{r}
lm6 <- lm(QQ_Gesamt_mean ~ CPE_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm6)
```

## Psychologische Sicherheit `PS` 
### QQ-Anand
```{r}
lm7 <- lm(QQ_Anand_mean ~ PS_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm7)
```

### Gesamte QQ-Skala
```{r}
lm8 <- lm(QQ_Gesamt_mean ~ PS_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm8)
```

## Servant Leadership `SL`
### QQ-Anand
```{r}
lm9 <- lm(QQ_Anand_mean ~ SL_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm9)
```

### Gesamte QQ-Skala
```{r}
lm9 <- lm(QQ_Gesamt_mean ~ SL_mean + Alter + Geschlecht + BZG + Gehalt, data=d_work_s)
summary(lm9)
```


## Moderation: PE moderiert den Zusammenhang von OCA und QQ-Gesamt
```{r}
d_work_plot_lm<- d_work_s %>% 
  mutate(CPE = case_when(
    CPE_mean <= 3.99 ~ "CPE_no",
    CPE_mean > 3.99 & CPE_mean < 4.99 ~ "CPE_neutral",
    CPE_mean >= 4.99 ~ "CPE_yes"
  ))
```

```{r}
ggplot(d_work_plot_lm)+
  geom_jitter(mapping = aes(x=OC_A_mean, y=QQ_Gesamt_mean))+
  geom_smooth(mapping = aes(x=OC_A_mean, y=QQ_Gesamt_mean, color=as.factor(CPE)), method = "lm", se=FALSE)
```

### Zentrieren
```{r}
d_work_s_TEST <- d_work_s %>% 
  mutate(CPE_c = (CPE_mean - mean(CPE_mean)),
         OCA_c = (OC_A_mean - mean(OC_A_mean)),
         QQ_gesamt_z = (QQ_Gesamt_mean - mean(QQ_Gesamt_mean)))
```

```{r}
d_work_plot_lm_1 <- d_work_plot_lm %>% 
  mutate(Alter_kat = case_when(
    Alter <= 33.5 ~ "jung",
    Alter > 33.5 ~ "alt"
  ))
```

## Moderation: Geschlecht moderiert den Zusammenhang von OCA und QQ-Gesamt
```{r}
ggplot(d_work_plot_lm_1+
  geom_jitter(mapping = aes(x=OC_A_mean, y=QQ_Gesamt_mean, color=as.factor(Alter_kat)))+
  geom_smooth(mapping = aes(x=OC_A_mean, y=QQ_Gesamt_mean, color=as.factor(Alter_kat)), method = "lm", se=FALSE)
```

### Hypothesenprüfung
```{r}
lm2 <- lm(QQ_Gesamt_mean ~ OC_A_mean + OC_A_mean*Alter_kat, d_work_plot_lm_1)
summary(lm2)
```




